/*!
 
 (c) 2022 impleCode - https://implecode.com
 */
function ic_register_block(Qe,e,r){const Fe=window.wp.blocks;const t=window.wp.blockEditor;const a=window.wp.element;const l=window.wp.components;const Le=window.wp.serverSideRender;const Me=window.wp.htmlEntities.decodeEntities;var De=a.createElement;var ze=t.InspectorControls;var Ue=l.SelectControl;var qe=l.TextControl;var Ge=l.RadioControl;var He=l.Spinner;var Je=l.Notice;var Ke=l.ToggleControl;var Ve=l.CheckboxControl;var We=l.SearchControl;var Xe=t.MediaPlaceholder;var Ye=l.Panel;var Ze=l.PanelBody;var $e=l.PanelRow;var et=t.AlignmentToolbar;var tt=l.ToolbarButton;var rt=t.BlockControls;var at=t.useBlockProps;var lt=a.useState;var st=[];var it=Qe.split("/");it=it[1];var s={};if(r!==undefined){s.from=[{type:"block",blocks:["core/legacy-widget"],isMatch:({idBase:e,instance:t})=>{if(t.raw===undefined){return false}return e===r},transform:({instance:e})=>{return Fe.createBlock(Qe,e.raw)}}]}Fe.registerBlockType(Qe,{transforms:s,usesContext:e,edit:function(s){const i=s.attributes;const e=Fe.getBlockSupport(Qe,"ic_fields");const[o,c]=lt(false);function t(e){s.setAttributes({title:e})}function r(e){s.setAttributes({shortcode_support:e})}function a(e){s.setAttributes({dropdown:e})}function l(e){s.setAttributes({count:e})}function n(e){s.setAttributes({hierarchical:e})}function d(e,t,r){if(Array.isArray(i.selectedCategory)){if(t!==undefined){var a=false;var l=nt(i);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedCategory:l})}if(i.category.length){s.setAttributes({category:[]})}if(l.length&&i.selectedProduct!==undefined&&i.selectedProduct.length){s.setAttributes({selectedProduct:[]})}}else{s.setAttributes({category:e})}}else{s.setAttributes({category:e})}}function u(e){s.setAttributes({orderby:e})}function p(e){s.setAttributes({order:e})}function f(e){s.setAttributes({archive_template:e})}function _(e){s.setAttributes({per_row:e})}function g(e){s.setAttributes({products_limit:e})}function b(e){s.setAttributes({no_add_to_cart:e})}function h(e,t,r){if(Array.isArray(i.selectedProduct)){if(t!==undefined){var a=false;var l=ct(i);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedProduct:l})}if(i.product!==undefined&&i.product.length){s.setAttributes({product:[]})}if(l.length&&i.selectedCategory!==undefined&&i.selectedCategory.length){s.setAttributes({selectedCategory:[]})}}}else{s.setAttributes({selectedProduct:parseInt(e,10)});if(o){c(false)}}}function y(e){s.setAttributes({alignment:e===undefined?"none":e})}function v(e){s.setAttributes({productSearch:e===undefined?"":e})}function k(e){s.setAttributes({categorySearch:e===undefined?"":e})}function m(e){s.setAttributes({productFromContext:e});if(e){if(i.product!==undefined&&i.product.length){s.setAttributes({product:[]})}if(i.category!==undefined&&i.category.length){s.setAttributes({product:[]})}if(i.selectedCategory!==undefined&&i.selectedCategory.length){s.setAttributes({selectedCategory:[]})}if(i.selectedProduct!==undefined){if(Array.isArray(i.selectedProduct)&&i.selectedProduct.length){s.setAttributes({selectedProduct:[]})}else{s.setAttributes({selectedProduct:0})}}if(i.categorySearch!==undefined&&i.categorySearch.length){s.setAttributes({categorySearch:""})}if(i.productSearch!==undefined&&i.productSearch.length){s.setAttributes({productSearch:""})}}}function w(e,t){s.setAttributes({[e]:t})}function A(e){s.setAttributes({image_id:e.id?e.id:0});s.setAttributes({image_id_url:e.url?e.url:""})}var j=[];var C=[];var x=[];var I={};var P=false;var S=[];var E=ot(i);s.attributes.ic_context_id=ic_blocks_js_global.context.id;s.attributes.ic_context_post_type=ic_blocks_js_global.context.type;var N=De(Le,{key:it+"-server-side-renderer",block:Qe,attributes:s.attributes});var O=N;if(i.title!==undefined){var T=i.title;C.push(De(qe,{label:ic_blocks_js_global.strings.select_title,value:T,key:it+"-title",type:"text",onChange:t}))}if(i.shortcode_support!==undefined){var B=i.shortcode_support;C.push(De(Ve,{label:ic_blocks_js_global.strings.select_shortcode_support,value:"1",key:it+"-shortcode-support",checked:B,type:"checkbox",onChange:r}))}if(i.dropdown!==undefined){var R=false;if(i.dropdown){R=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_dropdown,value:"1",key:it+"-dropdown",checked:R,type:"checkbox",onChange:a}))}if(i.count!==undefined){var Q=false;if(i.count){Q=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_count,value:"1",key:it+"-count",checked:Q,type:"checkbox",onChange:l}))}if(i.hierarchical!==undefined){var F=false;if(i.hierarchical){F=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_hierarchical,value:"1",key:it+"-hierarchical",checked:F,type:"checkbox",onChange:n}))}if(i.category!==undefined||i.selectedCategory!==undefined){var L=nt(i);var M=[];var D=E.categories;var z=E.selected_categories;var U=[];if(D){if(z){z.forEach(e=>{if(e.value!==undefined){U.push(parseInt(e.value,10));if(e.value!==0){M.push({value:parseInt(e.value,10),label:Me(e.label)})}}else{U.push(parseInt(e.id,10));if(e.id!==0){M.push({value:parseInt(e.id,10),label:Me(e.name)+" ("+e.count+")"})}}})}D.forEach(e=>{if(!U.includes(parseInt(e.id,10))){M.push({value:parseInt(e.id,10),label:Me(e.name)+" ("+e.count+")"})}})}var q="";var G=[];var H=[];var J="";if(i.categorySearch!==undefined){J=i.categorySearch;G.push(De(We,{label:ic_blocks_js_global.strings.search_category,value:J,type:"string",key:it+"-search-category",placeholder:ic_blocks_js_global.strings.category_search_placeholder,onChange:k}));M.forEach(t=>{H.push(De($e,{key:it+"-checkbox-row-category-"+t.value},De(Ve,{label:t.label,checked:U.includes(t.value),value:t.value,key:it+"-checkbox-category-"+t.value,onChange:function(e){d(e,t.value,t.label)}})))})}else{H.push(De($e,{key:it+"-category-select-panel-row"},De(Ue,{multiple:"multiple",label:"",key:it+"-category-select",value:L,options:M,onChange:d})))}if(M.length===0){if(E.ready){if(J){G.push(De(Je,{key:it+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword."))}}else{H.push(De(He,{key:it+"category-selector-loading"}))}}var K=De(Ze,{title:ic_blocks_js_global.strings.select_categories,key:it+"-category-select-panel-body",className:"ic-panel-body",initialOpen:L},H);if(H.length===0){K=""}x.push(K);var V=ic_blocks_js_global.strings.choose_categories;if(i.selectedProduct!==undefined){V=ic_blocks_js_global.strings.by_category}var W="ic-panel-body";if(!J&&(M.length<5||M.length===0)){W="ic-hidden-panel-body"}if(G.length){q=De(Ze,{title:ic_blocks_js_global.strings.search_category,key:it+"-search-category-panel-body",className:W,initialOpen:true},G)}var X=De(Ye,{header:V,key:it+"-main-panel"},q,K);if(L.length===0){if(S.length===0){P=true}}else{P=false}S.push(X)}if(i.orderby!==undefined){var Y=i.orderby;var Z=ic_blocks_js_global.category_orderby_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_orderby,value:Y,key:it+"-select-orderby",type:"dropdown",options:Z,onChange:u}))}if(i.order!==undefined){var $=i.order;var ee=ic_blocks_js_global.order_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_order,value:$,key:it+"-select-order",type:"dropdown",options:ee,onChange:p}))}if(i.archive_template!==undefined){if(i.archive_template===""&&ic_blocks_js_global.archive_template_def!==undefined){i.archive_template=ic_blocks_js_global.archive_template_def}var te=i.archive_template;var re=ic_blocks_js_global.template_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_template,value:te,key:it+"-select-template",type:"dropdown",options:re,onChange:f}))}if(i.per_row!==undefined){if(i.per_row===""&&ic_blocks_js_global.per_row_def!==undefined){i.per_row=ic_blocks_js_global.per_row_def}var ae=i.per_row;C.push(De(qe,{label:ic_blocks_js_global.strings.select_perrow,value:ae,key:it+"-select-per-row",type:"number",onChange:_}))}if(i.products_limit!==undefined){if(i.products_limit===""&&ic_blocks_js_global.products_limit_def!==undefined){i.products_limit=ic_blocks_js_global.products_limit_def}var le=i.products_limit;C.push(De(qe,{label:ic_blocks_js_global.strings.select_limit,value:le,key:it+"-select-products-limit",type:"number",onChange:g}))}if(i.no_add_to_cart!==undefined){var se=i.no_add_to_cart;if(ic_blocks_js_global.price_add_cart_added==="1"){C.push(De($e,{key:it+"-panel-body-row-noaddcart"},De(Ve,{label:ic_blocks_js_global.strings.disable_add_cart,checked:se,onChange:b})))}}if(e!==undefined){for(const[Pe,Se]of Object.entries(e)){if(i[Pe]!==undefined){var ie=typeof i[Pe];if(ie==="boolean"){C.push(De($e,{key:it+"-panel-body-row-"+Pe},De(Ve,{label:Se,checked:i[Pe],onChange:function(e){w(Pe,e)}})))}else if(ie==="string"){C.push(De(qe,{label:Se,value:i[Pe],key:it+"-"+Pe,type:"text",onChange:function(e){w(Pe,e)}}))}}}}if(i.alignment!==undefined){var oe=i.alignment;j.push(De(et,{value:oe,key:it+"-alignment",onChange:y}));I.textAlign=oe}if(i.productSearch!==undefined&&i.selectedProduct!==undefined){var ce=i.productSearch;var ne=ct(i);var de=[];st=[];var ue=[];var pe=[];if(Array.isArray(ne)&&ne.length!==0||!Array.isArray(ne)&&ne){ue=E.selected_products;if(ue){if(Array.isArray(ue)){ue.forEach(e=>{if(e.value!==undefined){pe.push(parseInt(e.value,10));st.push({value:parseInt(e.value,10),label:Me(e.label)})}else{pe.push(parseInt(e.id,10));st.push({value:parseInt(e.id,10),label:Me(e.title.rendered)})}})}else{pe.push(parseInt(ue,10));st.push({value:parseInt(ue,10),label:"Loading..."})}}}de=E.products;if(de){de.forEach(e=>{if(!pe.includes(parseInt(e.id,10))){st.push({value:parseInt(e.id,10),label:Me(e.title.rendered)})}})}var fe=[De($e,{key:it+"-panel-body-row-product-search"},De(We,{label:ic_blocks_js_global.strings.search_product,value:ce,type:"string",key:it+"-search-product",className:"ic-search-control",placeholder:ic_blocks_js_global.strings.search_placeholder,onChange:v}))];var _e=[];var ge=[];var be=[];var he=[];var ye=[];if(Array.isArray(ne)){st.forEach(t=>{be.push(De($e,{key:it+"-checkbox-row-product-"+t.value},De(Ve,{label:t.label,checked:pe.includes(t.value),value:t.value,key:it+"-checkbox-product-"+t.value,onChange:function(e){h(e,t.value,t.label)}})))})}else{be.push(De(Ge,{label:"",selected:ne,key:it+"-product",onChange:h,options:st}));if(i.productFromContext!==undefined){const Ee=i.productFromContext?ic_blocks_js_global.strings.context_enabled_help:ic_blocks_js_global.strings.context_disabled_help;const Ne=De(Ze,{title:"",key:it+"select-context-product-panel-body",className:"ic-panel-body",initialOpen:true},De($e,{key:it+"-panel-body-row-product-search-notice"},De(Ke,{label:ic_blocks_js_global.strings.get_product_from_context,checked:i.productFromContext,key:it+"-product-from-context",help:Ee,onChange:m})));if(i.productFromContext){he.push(Ne);ye.push(Ne)}else{_e.push(Ne);ge.push(Ne)}}}var ve=ic_blocks_js_global.strings.select_product;if(i.category!==undefined){ve=ic_blocks_js_global.strings.by_product}else{const Oe=Fe.getBlockType(s.name);const Te=Oe.title;ve=Te+" - "+ve}var ke="ic-panel-body";var me=0;if(ue){me+=ue.length}if(de){me+=de.length}if(!ce&&(me<10||me===0)){ke="ic-hidden-panel-body"}if(de===null||de.length===0){if(E.ready){if(ce){fe.push(De($e,{key:it+"-panel-body-row-product-search-notice"},De(Je,{key:it+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword.")))}}else{be.push(De(He,{key:it+"product-selector-loading"}))}}_e.push(De(Ze,{title:ic_blocks_js_global.strings.search_product,key:it+"-search-products-panel-body",className:ke,initialOpen:true},fe));_e.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:it+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},be));if(he.length){_e=he}var we=De(Ye,{header:ve,key:it+"-search-products-block-panel"},_e);ge.push(fe);ge.push(be);if(ye.length){ge=ye}x.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:it+"-side-search-products-panel-body",className:"ic-panel-body",initialOpen:false},ge));if(Array.isArray(ne)&&ne.length===0){if(S.length===0){P=true}}else{P=false}S.push(we)}if(i.image_id!==undefined){var Ae=[];const Be=window.wp.data.useSelect(e=>{const t=i.image_id&&e("core").getMedia(i.image_id);return t&&t.media_details.sizes.medium.source_url},[i.image_id]);const Re=!!Be&&De("img",{src:Be});Ae.push(De(Xe,{key:it+"image-id-selector",accept:"image/*",allowedTypes:["image"],multiple:false,onSelect:A,handleUpload:true,mediaPreview:Re}));S.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:it+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},De($e,{key:it+"-panel-body-row-image_id"},Ae)))}if(S.length!==0){j.push(De(tt,{icon:"edit",key:it+"-edit-button",title:ic_blocks_js_global.strings.edit_block,onClick:()=>c(!o),isActive:o||P}))}var je=[De(rt,{key:it+"-controls"},j)];var Ce=[];if(C.length){Ce.push(De(Ze,{title:ic_blocks_js_global.strings.options,key:it+"-main-panel-body",className:"main-panel-body",initialOpen:true},C))}if(x.length){Ce.push(x)}if(Ce.length){je.push(De(ze,{key:"ic-price-field-table-block-controls"},Ce))}if(o||P){O=S;P=true;if(!o){c(true)}}var xe="ic-block-output";if(P){xe+="-edit"}var Ie={key:it+"-div",className:xe};if(!o){Ie.style=I;if(S.length!==0&&j.length<=1){Ie.onClick=()=>c(true)}}je.push(De("div",at(Ie),O));return je},save:function(){return null}});function ot(g){const e=window.wp.data.useSelect(e=>{const t=e("core");var r={};r.ready=true;if(g.selectedCategory!==undefined){var a=nt(g);var l={per_page:-1,_fields:"id,name,count",orderby:"term_group"};if(g.categorySearch!==undefined){var s=g.categorySearch;l.per_page=10;if(s){l.search=s;l.per_page=-1}}if(a.length!==0){var i=true;var o={per_page:-1,_fields:"id,name,count",orderby:"include",include:a.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{i=false;return parseInt(e,10)}})};r.selected_categories=t.getEntityRecords("taxonomy","al_product-cat",o);if(r.selected_categories===null&&i){r.selected_categories=a}else{}if(r.selected_categories===null){r.ready=false}else if(r.selected_categories.length>=l.per_page&&l.per_page>0){l.per_page=l.per_page+r.selected_categories.length}}r.categories=t.getEntityRecords("taxonomy","al_product-cat",l);if(r.categories===null){r.ready=false}}if(g.productSearch!==undefined&&g.selectedProduct!==undefined){var c=ct(g);var n=g.productSearch;var d={per_page:10,_fields:"id,title"};if(Array.isArray(c)&&c.length!==0||!Array.isArray(c)&&c){var u=true;var p={per_page:-1,_fields:"id,title",orderby:"include",include:Array.isArray(c)?c.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{u=false;return parseInt(e,10)}}):c};r.selected_products=t.getEntityRecords("postType","al_product",p);if(r.selected_products===null&&u){r.selected_products=c}else{}if(r.selected_products===null){r.ready=false}else if(r.selected_products.length>=d.per_page){d.per_page=d.per_page+r.selected_products.length}}if(n){d.search=n;d.per_page=100}r.products=t.getEntityRecords("postType","al_product",d);if(r.products===null){r.ready=false}}if(!r.ready){for(const[f,_]of Object.entries(r)){r[f]=null}}return r});return e}function ct(e){var t=e.selectedProduct;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.product!==undefined&&e.product.length){t=e.product.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedProduct,10)}return t}function nt(e){var t=e.selectedCategory;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.category!==undefined&&e.category.length){t=e.category.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedCategory,10)}return t}}jQuery(window).on("load",function(){setTimeout(ic_block_meta_values_dynamic,1e3)});function ic_block_meta_values_dynamic(){jQuery(".ic-product-meta-field").each(function(){jQuery(this).on("change",function(){var e=jQuery(this).attr("name");var t={};t[e]=jQuery(this).val();wp.data.dispatch("core/editor").editPost({meta:t})})});wp.media.featuredImage.frame().on("select",function(){var e=wp.media.featuredImage.get();var t="_thumbnail_id";var r={};r[t]=e;wp.data.dispatch("core/editor").editPost({meta:r})});jQuery("#remove-post-thumbnail").on("click",function(){var e="_thumbnail_id";var t={};t[e]="";wp.data.dispatch("core/editor").editPost({meta:t})})}